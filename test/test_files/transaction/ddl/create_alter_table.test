-DATASET CSV empty
--

-DEFINE_STATEMENT_BLOCK CREATE_TABLE_TEST [
-STATEMENT CREATE NODE TABLE User(name STRING, age INT64, PRIMARY KEY (name))
---- ok
-STATEMENT CREATE REL TABLE Follow(FROM User TO User, since INT64)
---- ok
]

-DEFINE_STATEMENT_BLOCK ALTER_NODE_TABLE_TEST [
-STATEMENT ALTER TABLE User ADD email STRING
---- ok
]

-DEFINE_STATEMENT_BLOCK ALTER_NODE_TABLE_ROLLBACK [
-STATEMENT MATCH (u:User) return u.email
---- error
Binder exception: Cannot find property email for u.
]

-DEFINE_STATEMENT_BLOCK ALTER_NODE_TABLE_ONE_TX_ROLLBACK [
-STATEMENT MATCH (u:User) return u.email
---- error
Binder exception: Table User does not exist.
]

-DEFINE_STATEMENT_BLOCK ALTER_NODE_TABLE_COMMIT [
-STATEMENT MATCH (u:User) return u.email
---- ok
]


-DEFINE_STATEMENT_BLOCK ALTER_REL_TABLE_TEST [
-STATEMENT ALTER TABLE Follow ADD email STRING
---- ok
]

-DEFINE_STATEMENT_BLOCK ALTER_REL_TABLE_ROLLBACK [
-STATEMENT MATCH (u:User)-[e:Follow]->() return e.email
---- error
Binder exception: Cannot find property email for e.
]

-DEFINE_STATEMENT_BLOCK ALTER_REL_TABLE_ONE_TX_ROLLBACK [
-STATEMENT MATCH (u:User)-[e:Follow]->() return e.email
---- error
Binder exception: Table User does not exist.
]

-DEFINE_STATEMENT_BLOCK ALTER_REL_TABLE_COMMIT [
-STATEMENT MATCH (u:User)-[e:Follow]->() return e.email
---- ok
]

#-CASE createAlterTableCommit
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_TEST
#-STATEMENT COMMIT
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_COMMIT
#
#-CASE createAlterTableCommitRecovery
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_TEST
#-STATEMENT COMMIT_SKIP_CHECKPOINT
#---- ok
#-RELOADDB
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_COMMIT
#
#-CASE createAlterTableRollback
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_TEST
#-STATEMENT Rollback
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_ROLLBACK
#
#-CASE createAlterTableRollbackRecovery
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_TEST
#-STATEMENT Rollback_skip_checkpoint
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_ROLLBACK
#
#-CASE createAlterRelTableCommit
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_TEST
#-STATEMENT COMMIT
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_COMMIT
#
#-CASE createAlterRelTableCommitRecovery
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_TEST
#-STATEMENT COMMIT_SKIP_CHECKPOINT
#---- ok
#-RELOADDB
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_COMMIT
#
#-CASE createAlterRelTableRollback
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_TEST
#-STATEMENT Rollback
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_ROLLBACK
#
#-CASE createAlterRelTableRollbackRecovery
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_TEST
#-STATEMENT Rollback_skip_checkpoint
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_ROLLBACK
#
#
#-CASE createAlterTableOneTxCommit
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_TEST
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_COMMIT
#-STATEMENT COMMIT
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_COMMIT

-CASE createAlterTableOneTxCommitRecovery
-STATEMENT BEGIN TRANSACTION
---- ok
-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_TEST
-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_COMMIT
-STATEMENT COMMIT_SKIP_CHECKPOINT
---- ok
-RELOADDB
-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_COMMIT

#-CASE createAlterTableOneTxRollback
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_TEST
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_COMMIT
#-STATEMENT Rollback
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_ONE_TX_ROLLBACK
#
#-CASE createAlterTableOneTxRollbackRecovery
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_TEST
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_COMMIT
#-STATEMENT Rollback_Skip_Checkpoint
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_NODE_TABLE_ONE_TX_ROLLBACK
#
#-CASE createAlterRelTableOneTxCommit
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_TEST
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_COMMIT
#-STATEMENT COMMIT
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_COMMIT
#
#-CASE createAlterRelTableOneTxCommitRecovery
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_TEST
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_COMMIT
#-STATEMENT COMMIT_SKIP_CHECKPOINT
#---- ok
#-RELOADDB
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_COMMIT
#
#-CASE createAlterRelTableOneTxRollback
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_TEST
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_COMMIT
#-STATEMENT Rollback
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_ONE_TX_ROLLBACK
#
#-CASE createAlterRelTablOneTxeRollbackRecovery
#-STATEMENT BEGIN TRANSACTION
#---- ok
#-INSERT_STATEMENT_BLOCK CREATE_TABLE_TEST
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_TEST
#-STATEMENT Rollback_skip_checkpoint
#---- ok
#-INSERT_STATEMENT_BLOCK ALTER_REL_TABLE_ONE_TX_ROLLBACK
